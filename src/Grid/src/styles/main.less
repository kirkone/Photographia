@import "variab.less";
@import "font.less";

*, :after, :before {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body, html {
    scroll-behavior: smooth;
    font-family: @font;
    font-weight: 100;
    font-size: 1.1em;
}

input.function-switch {
    position: fixed;
    clip: rect(0,0,0,0);
    height: 0;
    width: 0;
}

label.function-switch {
    position: fixed;
    right: 18px;
    top: 18px;
    z-index: 301;
    height: 25px;
    width: 25px;
    cursor: pointer;

    color: var(--backgroundcolor-lighter);
    border: solid 1px var(--backgroundcolor-lighter);
    transition:
        border-color @transition-time ease-out,
        color @transition-time ease-out;

    &:hover {
        color: var(--backgroundcolor-lightest);
        border: solid 1px var(--backgroundcolor-lightest);

        &::before {
            border-bottom-color: var(--foregroundcolor-lightest);
        }
    }

}

input.function-switch:checked {
    + label {
        color: var(--foregroundcolor-lightest);
        border-color: var(--foregroundcolor-lightest);
    }
}

label[for=darkmode-switch] {
    &::before {
        content: "";
        position: absolute;
        width: 0;
        height: 0;
        bottom: 0;
        border-bottom: 23px solid var(--foregroundcolor-lighter);
        border-left: 23px solid transparent;

        transition: border-color @transition-time ease-out;
    }

    &:hover {
        border: solid 1px var(--backgroundcolor-lightest);

        &::before {
            border-bottom-color: var(--foregroundcolor-lightest);
        }
    }
}

label[for=settings-switch] {
    right:48px;

    &::after {
        content: "";
        display: block;
        box-sizing: border-box;
        position: absolute;
        width: 13px;
        height: 13px;
        border-bottom: 2px solid;
        border-right: 2px solid;
        transform: rotate(45deg);
        left: 5px;
        top: 3px
    }

    &:hover {
        border: solid 1px var(--backgroundcolor-lightest);

        &::before {
            border-bottom-color: var(--foregroundcolor-lightest);
        }
    }
}


label[for=image-fit-switch] {
    right:140px;
    top: calc(@spacer-height + 18px);
    opacity: 0;
    visibility: hidden;
    transition: all @transition-time ease-out;

    &::before {
        content: "";
        display: block;
        box-sizing: border-box;
        position: absolute;
        width: 13px;
        height: 13px;
        box-shadow:
            5px -5px 0 -4px,
            -5px 5px 0 -4px;
        left: 5px;
        top: 5px;
    }

    &::after {
        content: "";
        display: block;
        box-sizing: border-box;
        position: absolute;
        width: 9px;
        height: 1px;
        background: currentColor;
        transform: rotate(-45deg);
        top: 11px;
        left: 7px
    }
}

label.format-selector {
    position: fixed;
    top: calc(@spacer-height + 18px);
    z-index: 301;
    height: 25px;
    width: 25px;
    cursor: pointer;

    opacity: 0;
    visibility: hidden;

    transition: all @transition-time ease-out;
    border: solid 1px var(--backgroundcolor-lighter);

    &:hover {
        border-color: var(--backgroundcolor-lightest);
    }
}

label[for=format-selector-panorama] {
    right:105px;
    top: calc(@spacer-height + 23px);
    height: 15px;
}

label[for=format-selector-square] {
    right:75px;
}

label[for=format-selector-portrait] {
    right:55px;
    width: 15px;
}

#darkmode-switch:checked {
    + label {
        &::before {
            border-bottom-color: var(--backgroundcolor-lighter);
        }
    }

    ~ label.function-switch {
        border-color: var(--foregroundcolor-lightest);
        color:var(--foregroundcolor-lightest);
    }
    ~ label.function-switch:hover {
        border-color: var(--backgroundcolor-lightest);
        color:var(--backgroundcolor-lightest);
    }
    ~ input.function-switch:checked + label.function-switch {
        color: var(--backgroundcolor);
        border-color: var(--backgroundcolor);
    }

    ~ label.format-selector {
        color: var(--foregroundcolor-lightest);
        border-color: var(--foregroundcolor-lightest);
        &::before {
            border-bottom-color: var(--backgroundcolor-lightest);
        }

        &:hover {
            color: var(--backgroundcolor-lighter);
            border: solid 1px var(--backgroundcolor-lighter);

            &::before {
                border-bottom-color: var(--backgroundcolor-lighter);
            }
        }
    }

    ~ label.format-selector:hover {
        border-color: var(--backgroundcolor-lightest);
        color:var(--backgroundcolor-lightest);
    }
    ~ input.format-selector:checked + label.format-selector {
        color: var(--backgroundcolor);
        border-color: var(--backgroundcolor);
    }

    ~ *{
        --backgroundcolor:#f5f5f5;
        --backgroundcolor-trans:hsla(0,0%,96.1%,0.8);
        --backgroundcolor-light:#e3e3e3;
        --backgroundcolor-light-trans:hsla(0,0%,89%,0.8);
        --backgroundcolor-lighter:#d1d1d1;
        --foregroundcolor:#141414;
        --foregroundcolor-trans:rgba(20,20,20,0.8);
        --foregroundcolor-light:#262626;
        --foregroundcolor-light-trans:rgba(38,38,38,0.8);
        --foregroundcolor-lighter:#383838;
    }
}

#settings-backdrop {
    position: fixed;
    display: block;
    z-index: calc(@nav-z-index - 2);
    top: @spacer-height;
    right: 0;
    width: 100%;
    opacity: 0;
    visibility: hidden;
    transition: visibility @transition-time ease-out, opacity @transition-time ease-out;

    line-height: 60px;
    font-size: 1.5em;
    box-shadow: @box-shadow-down;
    
    background-color: var(--backgroundcolor-light-trans);
    backdrop-filter: blur(10px) saturate(125%);
    color: var(--foregroundcolor);

    @supports not (backdrop-filter: blur(10px)) {
        background-color: var(--backgroundcolor-light);
        backdrop-filter: none;
    }
}

#settings-switch:checked {
    + label {
        color: var(--foregroundcolor-lightest);
        border-color: var(--foregroundcolor-lightest);
    }

    &:checked {
        ~ #settings-backdrop {
            opacity: 1;
            visibility: visible;
        }

        ~ label.function-switch {
            opacity: 1;
            visibility: visible;
        }

        ~ label.format-selector {
            opacity: 1;
            visibility: visible;
        }
    }
}

#image-fit-switch:checked {
    ~ div.body {
        --grid-image-mode: cover;
    }
}

input.format-selector {
    position:fixed;
    clip:rect(0,0,0,0);
    height:0;
    width:0;

    &:checked{
        + label.format-selector{
            cursor:default;

            border-color: var(--foregroundcolor);
        }
    }
}

#format-selector-square:checked ~ div.body {
    --grid-article-aspect-ratio:100%;
}

#format-selector-portrait:checked ~ div.body {
    --grid-article-aspect-ratio:150%;
}

div.body, div.body * {
    transition: color @transition-time ease-out,
        background-color @transition-time ease-out;
}

div.body {
    color: var(--foregroundcolor);
    background-color: var(--backgroundcolor);
    min-height: 100vh;
    padding-top: @spacer-height;

    overflow: hidden;

    header{
        > div {
            position: fixed;
            top: 0;
            z-index: calc(@nav-z-index - 1);
            width: 100%;
            background-color: var(--backgroundcolor-light-trans);
            backdrop-filter: blur(10px) saturate(125%);
            line-height: 60px;
            padding-left: 65px;
            color: var(--foregroundcolor);
            font-size: 1.5em;
            box-shadow: @box-shadow-down;
            text-align: center;

            @supports not (backdrop-filter: blur(10px)) {
                background-color: var(--backgroundcolor-light);
                backdrop-filter: none;
            }
        }

        nav{
            transition: width @transition-time ease-out;
            position: fixed;
            left: -2px;
            top: 0;
            bottom: 0;
            width: 0;
            font-size: 1em;
            background: 0 0;
            background-color: var(--backgroundcolor-light-trans);
            backdrop-filter: blur(10px) saturate(125%);
            overflow: hidden;
            z-index: @nav-z-index;
            pointer-events: none;
            box-shadow: none;
            border-right: 1px solid var(--foregroundcolor-light);

            @supports not (backdrop-filter: blur(10px)) {
                background-color: var(--backgroundcolor-light);
                backdrop-filter: none;
            }

            #searchbox {
                label{
                    display:none;
                }

                input{
                    color: var(--backgroundcolor-light);
                    background-color: var(--foregroundcolor-light);
                    border: none;
                    font-size: 1.2em;
                    font-family: @font;
                    line-height: 60px;
                    display: inline-block;
                    width: 100%;
                    padding: 0 1rem;
                    -webkit-appearance: none;
                    border-radius: 0;
                }
            }

            span.devider {
                width: 100%;
                height: 30px;
                display: inline-block;
            }

            a {
                position: relative;
                padding: 0 1rem;
                text-decoration: none;
                color: var(--foregroundcolor);
                font-size: 1.2em;
                line-height: 60px;
                display: inline-block;
                width: 100%;
                transition: background-color @transition-time ease-out,
                    padding-left @transition-time ease-out;

                &:after{
                    content:"";
                    display: block;
                    position: absolute;
                    right: 0;
                    bottom: 0;
                    width: 0;
                    height: 1px;
                    background-color: var(--foregroundcolor-light);
                    transition: width @transition-time  ease-out;
                }

                &.active, &:hover {
                    color: var(--foregroundcolor-light);
                    padding-left: 1.3rem;

                    @supports not (backdrop-filter: blur(10px)) {
                        background-color: var(--backgroundcolor-lighter);
                        backdrop-filter: none;
                    }
                }

                &.active {
                    pointer-events: none;
                    cursor: default;
                }

                &.active:after, &:hover:after {
                    width: calc(100% - 1rem);
                    transition: width @transition-time ease-out;
                }

                &.devider {
                    pointer-events: none;
                    cursor: default;
                    line-height: 0;
                }
            }
        }

        .nav-trigger{
            position:fixed;
            clip:rect(0,0,0,0);
            height:0;
            width:0;
        }

        label[for=nav-trigger]{
            position:fixed;
            left:15px;
            top:15px;
            z-index:301;
            height:31px;
            width:35px;
            padding-left:5px;
            cursor:pointer;
            filter:drop-shadow(0 0 1px var(--backgroundcolor));
            transition:left @transition-time;

            * {
                -webkit-transition: all @transition-time ease-out;
                transition: all @transition-time ease-out;
                box-sizing: border-box;
            }

            &:hover i{
                background-color: var(--foregroundcolor-light);
            }

            i {
                display: block;
                position: absolute;
                height: 1px;
                width: 25px;
                background-color: var(--foregroundcolor);

                &:first-child{
                    top:6px;
                }

                &:nth-child(2){
                    top:14px;
                }
                &:nth-child(3){
                    top:22px;
                }
            }
        }

        .nav-trigger:checked {
            + label {
                left: calc(@nav-width + 16px);

                > i{
                    &:first-child {
                        -webkit-transform: translateY(-1px) rotate(-135deg);
                        transform: translateY(-1px) rotate(-135deg);
                        margin-top: 10px;
                    }

                    &:nth-child(2){
                        opacity:0;
                    }

                    &:nth-child(3) {
                        -webkit-transform: translateY(2px) rotate(135deg);
                        transform: translateY(2px) rotate(135deg);
                        margin-top: -12px;
                    }
                }

            }

            ~nav {
                width: @nav-width;
                pointer-events:all;
                box-shadow: @box-shadow-right;
            }
        }
    }

    .grid{
        display: grid;
        grid-template-columns: var(--grid-template-columns);
        grid-gap: @spacer-height;
        grid-auto-flow: dense;
        margin: @spacer-height;

        article {
            overflow: hidden;
            padding-top: var(--grid-article-aspect-ratio);
            position: relative;
            transition: padding-top @transition-time ease-out;
            box-shadow: @box-shadow-down;

            &:hover {
            }

            figure {
                position: absolute;
                top: -3%;
                left: -3%;
                height: calc(100% + 6%);
                width: calc(100% + 6%);


                img {
                    width: 100%;
                    height: 100%;
                    object-fit: var(--grid-image-mode);
                    transition: object-fit @transition-time ease-out;
                }
            }
        }
    }
}

// Media queries based on this:
// https://www.freecodecamp.org/news/the-100-correct-way-to-do-css-breakpoints-88d6a5ba1862/
@media screen and (max-width: 599px){
    div.body {
        header {
            > div {
                text-align: left;
            }

            nav{
                padding-top: 60px
            }

            .nav-trigger:checked {
                ~ nav{
                    width: 100vw
                }

                + label{
                    left: 15px
                }
            }
        }
        .grid{
            grid-template-columns: repeat(1,1fr)
        }
        .span-2,.span-3{
            grid-column-end:span 1;
            grid-row-end:span 1
        }
    }
}
@media screen and (min-width:600px){
    div.body {
        .grid{
            grid-template-columns:repeat(2,1fr)
        }
        .span-3{
            grid-column-end:span 2;
            grid-row-end:span 2
        }
}
}
@media screen and (min-width:900px){
    div.body {
        .grid{
            grid-template-columns:repeat(3,1fr)
        }
        .span-2{
            grid-column-end:span 2;
            grid-row-end:span 2
        }
        .span-3{
            grid-column-end:span 3;
            grid-row-end:span 3
        }
    }
}
@media screen and (min-width:1200px){
    div.body .grid{
        grid-template-columns:repeat(4,1fr)
    }
}
@media screen and (min-width:1800px){
    div.body .grid{
        grid-template-columns:repeat(auto-fit,minmax(400px, 1fr))
    }
}
